<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Bradaa Strategic Command v15.2 (Architect Edition)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Share+Tech+Mono&display=swap" rel="stylesheet">

    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#010409">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <style>
        :root {
            --c-bg: #010409;
            --c-glass: rgba(13, 17, 23, 0.6);
            --c-border: rgba(48, 54, 61, 0.8);
            --c-glow: rgba(0, 240, 255, 0.7);
            --c-accent-pink: #D83F87;
            --c-accent-cyan: #00F0FF;
            --c-text-primary: #E6EDF3;
            --c-text-secondary: #A8B2CC;
            --font-display: 'Orbitron', sans-serif;
            --font-body: 'Share Tech Mono', monospace;
        }
        body { font-family: var(--font-body); background-color: var(--c-bg); color: var(--c-text-primary); }
        body::before {
            content: ''; position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            width: 100vw; height: 100vh;
            background-image:
                radial-gradient(circle at 10% 20%, var(--c-accent-cyan), transparent 30%),
                radial-gradient(circle at 90% 80%, var(--c-accent-pink), transparent 30%),
                radial-gradient(circle at 50% 50%, #4A00E0, transparent 40%);
            background-size: 200% 200%; filter: blur(100px); opacity: 0.15; z-index: -1;
            animation: aurora 25s linear infinite;
        }
        @keyframes aurora { 0% { background-position: 0% 50%; } 50% { background-position: 100% 50%; } 100% { background-position: 0% 50%; } }
        .font-display { font-family: var(--font-display); text-shadow: 0 0 5px var(--c-accent-cyan), 0 0 10px var(--c-accent-cyan); }
        .card { background-color: var(--c-glass); backdrop-filter: blur(24px); border: 1px solid var(--c-border); border-radius: 0.75rem; position: relative; overflow: hidden; }
        .card::before {
            content: ''; position: absolute; top: 50%; left: 50%; width: 200%; height: 200%; z-index: 0;
            background: conic-gradient(from 180deg at 50% 50%, var(--c-accent-cyan), var(--c-accent-pink), var(--c-accent-cyan));
            transform: translate(-50%, -50%); opacity: 0; transition: opacity 0.5s ease-in-out; animation: rotate 8s linear infinite;
        }
        .card:hover::before { opacity: 0.5; }
        @keyframes rotate { 0% { transform: translate(-50%, -50%) rotate(0deg); } 100% { transform: translate(-50%, -50%) rotate(360deg); } }
        .card-content { position: relative; z-index: 1; padding: 1.5rem; }
        .nav-sticky { position: sticky; top: 0; z-index: 50; background-color: rgba(1, 4, 9, 0.7); backdrop-filter: blur(12px); border-bottom: 1px solid var(--c-border); }
        .nav-button { border-bottom: 2px solid transparent; transition: all 0.3s; }
        .nav-button:hover, .nav-button.active { color: var(--c-accent-cyan); border-bottom-color: var(--c-accent-cyan); text-shadow: 0 0 5px var(--c-accent-cyan); }
        .filter-button.active { background-color: var(--c-accent-pink); border-color: var(--c-accent-pink); color: var(--c-text-primary); }
        .tool-selector-btn { text-align: left; width: 100%; padding: 0.75rem; border-radius: 0.375rem; transition: all 0.2s; border: 1px solid transparent;}
        .tool-selector-btn:hover { background-color: var(--c-border); }
        .tool-selector-btn.active {
            background-color: var(--c-accent-cyan);
            color: var(--c-bg);
            border-color: var(--c-accent-cyan);
            font-weight: bold;
            box-shadow: 0 0 8px var(--c-accent-cyan), 0 0 16px rgba(0, 240, 255, 0.5);
        }
        ::-webkit-scrollbar { width: 8px; } ::-webkit-scrollbar-track { background: transparent; } ::-webkit-scrollbar-thumb { background: var(--c-border); border-radius: 4px; } ::-webkit-scrollbar-thumb:hover { background: var(--c-accent-cyan); }
        select, input, textarea { font-family: var(--font-body); background-color: rgba(1, 4, 9, 0.8); border: 1px solid var(--c-border); border-radius: 0.375rem; padding: 0.65rem; }
        .action-button { background-color: var(--c-accent-pink); color: white; padding: 0.65rem 1.5rem; font-weight: bold; border-radius: 0.375rem; transition: opacity 0.2s; cursor: pointer; } .action-button:hover { opacity: 0.9; }
        section { padding-top: 6rem; margin-top: -5rem; }
        .gemini-output { white-space: pre-wrap; line-height: 1.7; }
        .gemini-output h3 { font-family: var(--font-display); color: var(--c-accent-cyan); margin-top: 1rem; margin-bottom: 0.5rem;}
        .gemini-output ul { list-style-type: disc; padding-left: 1.5rem; }
        .gemini-output strong { color: var(--c-accent-pink); }

        @keyframes consoleFadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .console-animating > * {
            animation: consoleFadeIn 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <header class="text-center py-8">
            <h1 class="font-display text-4xl md:text-6xl font-black">AI BRADAA</h1>
            <p class="text-lg text-[var(--c-text-secondary)] mt-2">Powered by Kaa-Ching!</p>
        </header>

        <nav class="nav-sticky py-3 mb-12">
            <div class="flex flex-wrap justify-center gap-4 md:gap-6 text-sm">
                <a href="#matchmaker" class="nav-button active px-1 py-2 font-semibold">Matchmaker</a>
                <a href="#comparison" class="nav-button px-1 py-2 font-semibold">Versus</a>
                <a href="#explorer" class="nav-button px-1 py-2 font-semibold">Explorer</a>
                <a href="#toolkit" class="nav-button px-1 py-2 font-semibold">Ops Command</a>
                <a href="#intelligence" class="nav-button px-1 py-2 font-semibold">Intel</a>
                <a href="#appendices" class="nav-button px-1 py-2 font-semibold">Appendices</a>
                <a href="#camera-tech" class="nav-button px-1 py-2 font-semibold">Camera Tech</a>
            </div>
        </nav>

        <main class="space-y-16">
            <section id="matchmaker" class="card">
                <div class="card-content">
                    <h2 class="font-display text-2xl mb-4 text-[var(--c-accent-cyan)]">AI Laptop Matchmaker</h2>
                    <div class="grid md:grid-cols-2 gap-8 items-center">
                        <div class="space-y-4">
                            <p class="text-[var(--c-text-secondary)]">Yo. I'm AI Bradaa. Stop guessing. Provide your parameters, and I'll give you the optimal choice. Let's execute.</p>
                            <div><label class="block mb-2">1. Your Budget (MYR)</label><select id="match-budget" class="w-full"><option>Under RM4,500</option><option selected>RM4,500 - RM7,000</option><option>No Budget (Concierge)</option></select></div>
                            <div><label class="block mb-2">2. Primary Use Case</label><select id="match-usecase" class="w-full"><option>AI/ML & Coding</option><option>Creative Work (Video/3D)</option><option>Gaming & Everyday Use</option></select></div>
                            <div><label class="block mb-2">3. Portability Need</label><select id="match-portability" class="w-full"><option>Mostly at a desk</option><option>Always on the move</option><option>A mix of both</option></select></div>
                            <button id="find-match-btn" class="w-full action-button">✨ Find My Match</button>
                        </div>
                        <div id="matchmaker-output" class="p-4 bg-[var(--c-bg)] rounded-lg min-h-[250px] text-[var(--c-text-secondary)] gemini-output">Your AI recommendation will appear here...</div>
                    </div>
                </div>
            </section>

            <section id="comparison" class="card">
                <div class="card-content">
                    <h2 class="font-display text-2xl mb-4 text-[var(--c-accent-cyan)]">Head-to-Head Comparison</h2>
                    <p class="text-sm text-[var(--c-text-secondary)] mb-4">Select 2 or 3 units for a tactical breakdown. AI Bradaa will generate an automated strategic analysis.</p>
                    <div class="max-h-48 overflow-y-auto grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-7 gap-2 mb-6 p-2 bg-[var(--c-bg)] rounded-lg" id="laptop-selector-container">Loading Intel...</div>
                    <div class="grid md:grid-cols-2 gap-8 items-center">
                         <div style="position: relative; height:450px;"><canvas id="radarChart"></canvas></div>
                         <div id="gemini-comparison-output" class="p-4 bg-[var(--c-bg)] rounded-lg min-h-[300px] text-sm text-[var(--c-text-secondary)] gemini-output">Select laptops to begin analysis...</div>
                    </div>
                </div>
            </section>

            <section id="explorer" class="card">
                <div class="card-content">
                    <h2 class="font-display text-2xl mb-4 text-[var(--c-accent-cyan)]">Interactive Market Explorer</h2>
                    <div id="filters" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 p-4 bg-[var(--c-bg)] rounded-lg">
                        <div><label class="font-semibold text-sm mb-2 block">Price Range (≤ RM<span id="price-value">7000</span>)</label><input type="range" id="price-filter" min="3500" max="7000" value="7000" step="100" class="w-full"></div>
                        <div><label class="font-semibold text-sm mb-2 block">Platform</label><div class="flex gap-2"><button class="filter-button platform-filter flex-1 border border-[var(--c-border)] px-3 py-2 text-sm rounded-md active" data-platform="All">All</button><button class="filter-button platform-filter flex-1 border border-[var(--c-border)] px-3 py-2 text-sm rounded-md" data-platform="CUDA">CUDA</button><button class="filter-button platform-filter flex-1 border border-[var(--c-border)] px-3 py-2 text-sm rounded-md" data-platform="NPU">NPU</button><button class="filter-button platform-filter flex-1 border border-[var(--c-border)] px-3 py-2 text-sm rounded-md" data-platform="Mac">Mac</button></div></div>
                        <div><label class="font-semibold text-sm mb-2 block">Brand</label><select id="brand-filter" class="w-full"><option value="All" selected>All Brands</option></select></div>
                        <div><label class="font-semibold text-sm mb-2 block">Sort By</label><select id="sort-filter" class="w-full"><option value="score_desc" selected>Score (High-Low)</option><option value="price_asc">Price (Low-High)</option><option value="price_desc">Price (High-Low)</option><option value="value_desc">Value Rating (Score-to-Price Ratio)</option></select></div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-8 mb-8">
                        <div style="position: relative; height:500px;"><canvas id="rankingsChart"></canvas></div>
                        <div style="position: relative; height:500px;"><canvas id="valueChart"></canvas></div>
                    </div>
                </div>
            </section>

            <section id="toolkit" class="card">
                <div class="card-content">
                    <h2 class="font-display text-2xl mb-4 text-[var(--c-accent-cyan)]">Advanced AI Toolkit</h2>
                    <div class="grid md:grid-cols-3 gap-8">
                        <div class="md:col-span-1 space-y-2 max-h-[600px] overflow-y-auto">
                            <button class="tool-selector-btn active" data-tool="deal-assassin">Deal Assassin</button>
                            <button class="tool-selector-btn" data-tool="upgrade-strategist">Upgrade Strategist</button>
                            <button class="tool-selector-btn" data-tool="dream-rig-architect">Dream Rig Architect</button>
                            <button class="tool-selector-btn" data-tool="elite-procurement">Elite Procurement</button>
                            <button class="tool-selector-btn" data-tool="component-recon">Component Recon</button>
                            <button class="tool-selector-btn" data-tool="performance-forecaster">Performance Forecaster</button>
                            <button class="tool-selector-btn" data-tool="system-integrity">System Integrity Analysis</button>
                            <button class="tool-selector-btn" data-tool="ecosystem-architect">Ecosystem Architect</button>
                            <button class="tool-selector-btn" data-tool="longevity-analyst">Longevity Analyst</button>
                            <button class="tool-selector-btn" data-tool="asset-value">Asset Value Forecaster</button>
                            <button class="tool-selector-btn" data-tool="field-support">Field Support</button>
                        </div>
                        <div id="toolkit-console" class="md:col-span-2 bg-[var(--c-bg)] p-4 rounded-lg flex flex-col">
                        </div>
                    </div>
                </div>
            </section>

             <section id="intelligence" class="card">
                <div class="card-content">
                    <h2 class="font-display text-2xl mb-4 text-[var(--c-accent-cyan)]">Latest Tech Intel</h2>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                        <div class="p-4 bg-[var(--c-bg)] rounded-lg">
                            <h3 id="intel-0-title" class="font-display text-lg text-[var(--c-accent-pink)]">Acquiring Intel...</h3>
                            <p id="intel-0-summary" class="text-xs text-[var(--c-text-secondary)] mt-2">AI Bradaa is scanning for intel...</p>
                            <p class="mt-3 font-semibold">Verdict: <span id="intel-0-verdict" class="text-[var(--c-accent-pink)]">STANDBY</span></p>
                        </div>
                        <div class="p-4 bg-[var(--c-bg)] rounded-lg">
                            <h3 id="intel-1-title" class="font-display text-lg text-[var(--c-accent-cyan)]">Acquiring Intel...</h3>
                            <p id="intel-1-summary" class="text-xs text-[var(--c-text-secondary)] mt-2">AI Bradaa is scanning for intel...</p>
                            <p class="mt-3 font-semibold">Verdict: <span id="intel-1-verdict" class="text-[var(--c-accent-cyan)]">STANDBY</span></p>
                        </div>
                        <div class="p-4 bg-[var(--c-bg)] rounded-lg">
                            <h3 id="intel-2-title" class="font-display text-lg text-[var(--c-text-secondary)]">Acquiring Intel...</h3>
                            <p id="intel-2-summary" class="text-xs text-[var(--c-text-secondary)] mt-2">AI Bradaa is scanning for intel...</p>
                            <p class="mt-3 font-semibold">Verdict: <span id="intel-2-verdict" class="text-[var(--c-text-secondary)]">STANDBY</span></p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="appendices" class="card">
                <div class="card-content">
                    <h2 class="font-display text-2xl mb-4 text-[var(--c-accent-cyan)]">Appendices: Full Laptop Database</h2>
                    <p class="text-sm text-[var(--c-text-secondary)] mb-4 text-center">This list is updated automatically by the filters in the <a href="#explorer" class="underline text-[var(--c-accent-cyan)]">Explorer</a> section.</p>
                    <div id="laptop-list-container" class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6 max-h-[80vh] overflow-y-auto p-2">
                        <p class="text-center xl:col-span-3">Loading market data...</p>
                    </div>
                </div>
            </section>

            <section id="camera-tech" class="card">
                <div class="card-content flex flex-col justify-center items-center text-center min-h-[250px]">
                    <h2 class="font-display text-2xl text-[var(--c-text-secondary)]">Camera Tech Division</h2>
                    <p class="mt-4 text-[var(--c-text-secondary)]">A new strategic vertical is under development.</p>
                    <p class="font-display text-4xl mt-4 animate-pulse">COMING SOON</p>
                </div>
            </section>
        </main>
    </div>

<script>
/* ==========================================================================
   AI Bradaa Strategic Command — v15.2 (Architect Edition)
   Code refactored for clarity, performance, and robustness.
   All AI features are live and persona-aligned.
   ========================================================================== */
(() => {
  'use strict';

  // --- STATE & CONSTANTS ----------------------------------------------------
  // Centralized state object. The single source of truth for the application's data.
  const STATE = {
    data: {
      allLaptops: [],
      sortedByRank: [],
      fallbackLaptops: [
          { "brand": "Illegear", "model": "Illegear Z7 (2025)", "price": 6899, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Illegear+Z7", "cpu": "Intel Core i7-14700HX", "gpu": "NVIDIA RTX 4060 8GB", "ram": "16GB DDR5 5600MHz", "storage": "1TB NVMe Gen4 SSD", "display": "17.3\" QHD 240Hz", "price_source_url": "https://www.illegear.com/laptops/z7/", "shopee_url": "https://shopee.com.my/search?keyword=Illegear%20Z7", "tiktok_url": "https://www.tiktok.com/tag/illegearz7", "score": 95, "platform": "CUDA", "why": "Exceptional thermal performance and full-power RTX 4060.", "scores": { "ai": 9, "thermals": 10, "upgrade": 9, "linux": 7, "portability": 6, "value": 9 } },
          { "brand": "Lenovo", "model": "Legion Slim 5 16APH8", "price": 6299, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Legion+Slim+5", "cpu": "AMD Ryzen 7 7840HS", "gpu": "NVIDIA RTX 4060 8GB", "ram": "16GB DDR5 5600MHz", "storage": "512GB NVMe Gen4 SSD", "display": "16\" WQXGA 165Hz", "price_source_url": "https://www.lenovo.com/my/en/p/laptops/legion-laptops/legion-slim-series/legion-slim-5-gen-8-(16-inch-amd)/82y9006qmj", "shopee_url": "https://shopee.com.my/search?keyword=Legion%20Slim%205", "tiktok_url": null, "score": 93, "platform": "CUDA", "why": "Outstanding balance of build quality, performance, and aesthetic.", "scores": { "ai": 9, "thermals": 9, "upgrade": 8, "linux": 8, "portability": 7, "value": 9 } },
          { "brand": "ASUS", "model": "ROG Zephyrus G14 (2023)", "price": 6999, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Zephyrus+G14", "cpu": "AMD Ryzen 7 7735HS", "gpu": "NVIDIA RTX 4050 6GB", "ram": "16GB DDR5", "storage": "512GB NVMe SSD", "display": "14\" QHD+ 165Hz", "price_source_url": "https://www.asus.com/my/laptops/for-gaming/rog-republic-of-gamers/rog-zephyrus-g14-2023/", "shopee_url": "https://shopee.com.my/search?keyword=Zephyrus%20G14%202023", "tiktok_url": "https://www.tiktok.com/tag/zephyrusg14", "score": 92, "platform": "CUDA", "why": "Benchmark for compact power; incredible performance in a 14-inch chassis.", "scores": { "ai": 8, "thermals": 8, "upgrade": 7, "linux": 8, "portability": 9, "value": 8 } },
          { "brand": "ASUS", "model": "TUF Gaming A16 FA617NS", "price": 5599, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=ASUS+TUF+A16", "cpu": "AMD Ryzen 9 7940HS", "gpu": "AMD Radeon RX 7600S", "ram": "16GB DDR5 4800MHz", "storage": "512GB NVMe Gen4 SSD", "display": "16\" FHD+ 165Hz", "price_source_url": "https://www.asus.com/my/laptops/for-gaming/tuf-gaming/asus-tuf-gaming-a16-advantage-edition-2023/", "shopee_url": "https://shopee.com.my/search?keyword=TUF%20Gaming%20A16", "tiktok_url": null, "score": 91, "platform": "CUDA", "why": "All-AMD advantage provides incredible efficiency and battery life.", "scores": { "ai": 8, "thermals": 9, "upgrade": 8, "linux": 9, "portability": 6, "value": 10 } },
          { "brand": "Gigabyte", "model": "AORUS 15 (2024)", "price": 6999, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Gigabyte+AORUS", "cpu": "Intel Core i7-13700H", "gpu": "NVIDIA RTX 4060 8GB", "ram": "16GB DDR5", "storage": "1TB NVMe Gen4 SSD", "display": "15.6\" QHD 165Hz", "price_source_url": "https://www.gigabyte.com/my/Laptop/AORUS-15--2024", "shopee_url": "https://shopee.com.my/search?keyword=AORUS%2015%20BKG", "tiktok_url": null, "score": 90, "platform": "CUDA", "why": "Premium gaming build with a high-TGP RTX 4060 at budget's edge.", "scores": { "ai": 9, "thermals": 9, "upgrade": 8, "linux": 6, "portability": 5, "value": 8 } },
          { "brand": "Aftershock", "model": "Apex 15X (Gen 13)", "price": 6450, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Aftershock+Apex", "cpu": "Intel Core i7-13700HX", "gpu": "NVIDIA RTX 4060 8GB", "ram": "16GB DDR5", "storage": "1TB NVMe Gen4 SSD", "display": "15.6\" QHD 165Hz", "price_source_url": "https://www.aftershockpc.com.my/products/apex-15x-13th-gen-rtx-4060", "shopee_url": "https://shopee.com.my/search?keyword=Aftershock%20Apex%2015X", "tiktok_url": null, "score": 90, "platform": "CUDA", "why": "Highly customizable, offering desktop-like power in a laptop form factor.", "scores": { "ai": 9, "thermals": 9, "upgrade": 10, "linux": 7, "portability": 5, "value": 8 } },
          { "brand": "Apple", "model": "MacBook Air 15-inch (M3)", "price": 6999, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=MacBook+Air+15", "cpu": "Apple M3 Chip", "gpu": "10-core GPU", "ram": "8GB Unified Memory", "storage": "512GB SSD", "display": "15.3\" Liquid Retina", "price_source_url": "https://www.apple.com/my/shop/buy-mac/macbook-air/15-inch-m3", "shopee_url": "https://shopee.com.my/search?keyword=MacBook%20Air%2015%20M3", "tiktok_url": "https://www.tiktok.com/tag/macbookairm3", "score": 89, "platform": "Mac", "why": "Unbeatable power efficiency and silent, fanless design for AI on the go.", "scores": { "ai": 8, "thermals": 10, "upgrade": 1, "linux": 1, "portability": 10, "value": 7 } },
          { "brand": "Lenovo", "model": "IdeaPad Pro 5 16AHP9", "price": 5499, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=IdeaPad+Pro+5", "cpu": "AMD Ryzen 7 8845HS", "gpu": "NVIDIA RTX 3050 6GB", "ram": "16GB LPDDR5X", "storage": "1TB NVMe SSD", "display": "16\" 2.5K 120Hz", "price_source_url": "https://www.lenovo.com/my/en/p/laptops/ideapad/ideapad-pro-series/ideapad-pro-5-gen-9-(16-inch-amd)/len101i0062", "shopee_url": "https://shopee.com.my/search?keyword=IdeaPad%20Pro%205%2016AHP9", "tiktok_url": null, "score": 88, "platform": "NPU", "why": "Powerful AMD Ryzen 8000 series NPU for productive multitasking.", "scores": { "ai": 8, "thermals": 8, "upgrade": 2, "linux": 8, "portability": 6, "value": 9 } },
          { "brand": "Razer", "model": "Razer Blade 14 (2023)", "price": 6999, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Razer+Blade+14", "cpu": "AMD Ryzen 9 7940HS", "gpu": "NVIDIA RTX 4050 6GB", "ram": "16GB LPDDR5X", "storage": "1TB NVMe SSD", "display": "14\" QHD+ 240Hz", "price_source_url": "https://www.razer.com/my-en/gaming-laptops/Razer-Blade-14/RZ09-0493BND3-R3B1", "shopee_url": "https://shopee.com.my/search?keyword=Razer%20Blade%2014%202023", "tiktok_url": null, "score": 88, "platform": "CUDA", "why": "Unparalleled CNC-milled aluminum build quality in a compact form factor.", "scores": { "ai": 8, "thermals": 8, "upgrade": 1, "linux": 6, "portability": 9, "value": 7 } },
          { "brand": "Acer", "model": "Swift Go 14 AI", "price": 4599, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Acer+Swift+Go", "cpu": "Intel Core Ultra 7 155H", "gpu": "Intel Arc Graphics", "ram": "16GB LPDDR5X", "storage": "1TB NVMe Gen4 SSD", "display": "14\" 2.8K OLED 90Hz", "price_source_url": "https://store.acer.com/en-my/acer-swift-go-14-ai-sfg14-72-79h9", "shopee_url": "https://shopee.com.my/search?keyword=Acer%20Swift%20Go%2014%20AI", "tiktok_url": null, "score": 88, "platform": "NPU", "why": "Excellent value Intel Ultra NPU laptop with a stunning OLED display.", "scores": { "ai": 7, "thermals": 7, "upgrade": 2, "linux": 6, "portability": 9, "value": 10 } },
          { "brand": "Dell", "model": "Inspiron 16 Plus (7640)", "price": 6599, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Dell+Inspiron+16", "cpu": "Intel Core Ultra 7 155H", "gpu": "Intel Arc Graphics", "ram": "16GB DDR5", "storage": "1TB NVMe Gen4 SSD", "display": "16\" 2.5K 120Hz", "price_source_url": "https://www.dell.com/my/p/inspiron-16-7640-laptop/pd", "shopee_url": "https://shopee.com.my/search?keyword=Inspiron%2016%20Plus%207640", "tiktok_url": null, "score": 87, "platform": "NPU", "why": "Large, high-resolution display and robust Intel Ultra 7 processor.", "scores": { "ai": 8, "thermals": 8, "upgrade": 8, "linux": 7, "portability": 6, "value": 8 } },
          { "brand": "Aftershock", "model": "Nova 16X", "price": 5500, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Aftershock+Nova", "cpu": "Intel Core i7-13700H", "gpu": "NVIDIA RTX 4050 6GB", "ram": "16GB DDR5", "storage": "512GB NVMe SSD", "display": "16\" QHD+ 165Hz", "price_source_url": "https://www.aftershockpc.com.my/products/nova-16x-rtx-4050", "shopee_url": "https://shopee.com.my/search?keyword=Aftershock%20Nova%2016X", "tiktok_url": null, "score": 87, "platform": "CUDA", "why": "Fantastic balance of customizability, strong performance, and value.", "scores": { "ai": 8, "thermals": 8, "upgrade": 10, "linux": 7, "portability": 6, "value": 9 } },
          { "brand": "HP", "model": "Omen 16 (2024)", "price": 6999, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=HP+Omen+16", "cpu": "Intel Core i7-14700HX", "gpu": "NVIDIA RTX 4060 8GB", "ram": "16GB DDR5 5600MHz", "storage": "1TB NVMe Gen4 SSD", "display": "16.1\" QHD 240Hz", "price_source_url": "https://www.hp.com/my-en/shop/laptops-tablets/omen-gaming-laptop-16-wf1030tx-9p2v1pa.html", "shopee_url": "https://shopee.com.my/search?keyword=HP%20Omen%2016", "tiktok_url": null, "score": 86, "platform": "CUDA", "why": "Mature design with strong thermal performance for work and play.", "scores": { "ai": 9, "thermals": 9, "upgrade": 7, "linux": 7, "portability": 5, "value": 7 } },
          { "brand": "Illegear", "model": "IONIC 15", "price": 5298, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Illegear+IONIC", "cpu": "AMD Ryzen 7 8845HS", "gpu": "AMD Radeon 780M", "ram": "16GB LPDDR5X", "storage": "512GB NVMe Gen4 SSD", "display": "15.6\" WQHD 165Hz", "price_source_url": "https://www.illegear.com/laptops/ionic-15-2024/", "shopee_url": "https://shopee.com.my/search?keyword=Illegear%20IONIC%2015", "tiktok_url": null, "score": 86, "platform": "NPU", "why": "Magnesium alloy chassis offers premium feel and strong AMD NPU.", "scores": { "ai": 8, "thermals": 8, "upgrade": 2, "linux": 8, "portability": 8, "value": 9 } },
          { "brand": "ASUS", "model": "Zenbook 14 OLED (UX3405)", "price": 5999, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Zenbook+14", "cpu": "Intel Core Ultra 9 185H", "gpu": "Intel Arc Graphics", "ram": "32GB LPDDR5X", "storage": "1TB NVMe SSD", "display": "14\" 3K OLED 120Hz", "price_source_url": "https://www.asus.com/my/laptops/for-home/zenbook/asus-zenbook-14-oled-ux3405/", "shopee_url": "https://shopee.com.my/search?keyword=Zenbook%2014%20UX3405", "tiktok_url": "https://www.tiktok.com/tag/zenbook14oled", "score": 85, "platform": "NPU", "why": "Incredibly thin, light, and premium, with top-tier Intel NPU.", "scores": { "ai": 8, "thermals": 7, "upgrade": 1, "linux": 6, "portability": 10, "value": 7 } },
          { "brand": "MSI", "model": "Cyborg 15 A13VF", "price": 5299, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=MSI+Cyborg+15", "cpu": "Intel Core i7-13620H", "gpu": "NVIDIA RTX 4060 8GB", "ram": "16GB DDR5", "storage": "512GB NVMe Gen4 SSD", "display": "15.6\" FHD 144Hz", "price_source_url": "https://my.msi.com/Laptop/Cyborg-15-A13VX/Specification", "shopee_url": "https://shopee.com.my/search?keyword=MSI%20Cyborg%2015", "tiktok_url": null, "score": 85, "platform": "CUDA", "why": "Aggressively priced entry into the RTX 4060 space.", "scores": { "ai": 9, "thermals": 7, "upgrade": 7, "linux": 6, "portability": 6, "value": 9 } },
          { "brand": "Acer", "model": "Predator Helios Neo 16", "price": 6399, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Predator+Helios", "cpu": "Intel Core i5-13500HX", "gpu": "NVIDIA RTX 4060 8GB", "ram": "16GB DDR5", "storage": "512GB NVMe SSD", "display": "16\" WQXGA 165Hz", "price_source_url": "https://store.acer.com/en-my/predator-helios-neo-16-phn16-71-55v5", "shopee_url": "https://shopee.com.my/search?keyword=Predator%20Helios%20Neo%2016", "tiktok_url": null, "score": 84, "platform": "CUDA", "why": "Excellent cooling allows the RTX 4060 to provide great performance.", "scores": { "ai": 9, "thermals": 9, "upgrade": 7, "linux": 6, "portability": 5, "value": 7 } },
          { "brand": "ASUS", "model": "Vivobook S 15 OLED (S5506)", "price": 5199, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Vivobook+S15", "cpu": "Intel Core Ultra 7 155H", "gpu": "Intel Arc Graphics", "ram": "16GB LPDDR5X", "storage": "1TB NVMe Gen4 SSD", "display": "15.6\" 3K OLED 120Hz", "price_source_url": "https://www.asus.com/my/laptops/for-home/vivobook/asus-vivobook-s-15-oled-s5506/", "shopee_url": "https://shopee.com.my/search?keyword=Vivobook%20S%2015%20OLED", "tiktok_url": null, "score": 84, "platform": "NPU", "why": "Stunning OLED display paired with the latest Intel Ultra chip.", "scores": { "ai": 8, "thermals": 7, "upgrade": 2, "linux": 6, "portability": 8, "value": 8 } },
          { "brand": "Samsung", "model": "Galaxy Book4 Pro", "price": 6799, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Galaxy+Book4", "cpu": "Intel Core Ultra 7 155H", "gpu": "Intel Arc Graphics", "ram": "16GB LPDDR5X", "storage": "512GB NVMe SSD", "display": "14\" Dynamic AMOLED 2X", "price_source_url": "https://www.samsung.com/my/computers/galaxy-book/galaxy-book4-pro-14-inch-i7-16gb-512gb-np940xgk-kg1my/", "shopee_url": "https://shopee.com.my/search?keyword=Galaxy%20Book4%20Pro", "tiktok_url": null, "score": 84, "platform": "NPU", "why": "Exceptional AMOLED display and seamless Samsung ecosystem integration.", "scores": { "ai": 8, "thermals": 7, "upgrade": 1, "linux": 5, "portability": 9, "value": 7 } },
          { "brand": "Gigabyte", "model": "G5 MF", "price": 4399, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Gigabyte+G5", "cpu": "Intel Core i5-12500H", "gpu": "NVIDIA RTX 4050 6GB", "ram": "8GB DDR4", "storage": "512GB NVMe Gen4 SSD", "display": "15.6\" FHD 144Hz", "price_source_url": "https://www.gigabyte.com/my/Laptop/G5--2023", "shopee_url": "https://shopee.com.my/search?keyword=Gigabyte%20G5%20MF", "tiktok_url": null, "score": 83, "platform": "CUDA", "why": "Most affordable RTX 4050, accessible for CUDA development.", "scores": { "ai": 8, "thermals": 7, "upgrade": 8, "linux": 7, "portability": 6, "value": 10 } },
          { "brand": "Dell", "model": "XPS 13 (9340)", "price": 6999, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Dell+XPS+13", "cpu": "Intel Core Ultra 7 155H", "gpu": "Intel Arc Graphics", "ram": "16GB LPDDR5X", "storage": "512GB NVMe SSD", "display": "13.4\" FHD+ InfinityEdge", "price_source_url": "https://www.dell.com/my/p/xps-13-9340-laptop/pd", "shopee_url": "https://shopee.com.my/search?keyword=Dell%20XPS%2013%209340", "tiktok_url": null, "score": 83, "platform": "NPU", "why": "Iconic, ultra-premium design and build for NPU-accelerated tasks.", "scores": { "ai": 8, "thermals": 7, "upgrade": 1, "linux": 7, "portability": 10, "value": 6 } },
          { "brand": "Dell", "model": "Inspiron 14 Plus (7440)", "price": 5499, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Dell+Inspiron+14", "cpu": "Intel Core Ultra 7 155H", "gpu": "Intel Arc Graphics", "ram": "16GB LPDDR5X", "storage": "1TB NVMe SSD", "display": "14\" 2.2K IPS", "price_source_url": "https://www.dell.com/my/p/inspiron-14-7440-laptop/pd", "shopee_url": "https://shopee.com.my/search?keyword=Inspiron%2014%20Plus%207440", "tiktok_url": null, "score": 83, "platform": "NPU", "why": "Compact and powerful with an Intel Ultra 7, great portability/performance balance.", "scores": { "ai": 8, "thermals": 7, "upgrade": 2, "linux": 7, "portability": 9, "value": 8 } },
          { "brand": "MSI", "model": "Prestige 14 AI Evo", "price": 6399, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=MSI+Prestige+14", "cpu": "Intel Core Ultra 7 155H", "gpu": "Intel Arc Graphics", "ram": "16GB LPDDR5", "storage": "1TB NVMe Gen4 SSD", "display": "14\" FHD+ IPS", "price_source_url": "https://my.msi.com/Business-Productivity/Prestige-14-AI-Evo-A1MX", "shopee_url": "https://shopee.com.my/search?keyword=MSI%20Prestige%2014%20AI", "tiktok_url": null, "score": 83, "platform": "NPU", "why": "Business-focused ultrabook with robust security and lightweight design.", "scores": { "ai": 8, "thermals": 7, "upgrade": 2, "linux": 6, "portability": 9, "value": 7 } },
          { "brand": "Dell", "model": "G15 5530 Gaming", "price": 5899, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Dell+G15", "cpu": "Intel Core i7-13650HX", "gpu": "NVIDIA RTX 4060 8GB", "ram": "16GB DDR5", "storage": "512GB NVMe SSD", "display": "15.6\" FHD 165Hz", "price_source_url": "https://www.dell.com/my/p/g-series-15-5530-laptop/pd", "shopee_url": "https://shopee.com.my/search?keyword=Dell%20G15%205530", "tiktok_url": null, "score": 82, "platform": "CUDA", "why": "Reliable build and thermal design offering a consistent RTX 4060 experience.", "scores": { "ai": 9, "thermals": 8, "upgrade": 7, "linux": 7, "portability": 5, "value": 7 } },
          { "brand": "Lenovo", "model": "Yoga Slim 7i 14IMH9", "price": 5099, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Yoga+Slim+7i", "cpu": "Intel Core Ultra 7 155H", "gpu": "Intel Arc Graphics", "ram": "16GB LPDDR5X", "storage": "1TB NVMe Gen4 SSD", "display": "14\" WUXGA OLED", "price_source_url": "https://www.lenovo.com/my/en/p/laptops/yoga/yoga-slim-series/yoga-slim-7i-gen-9-(14-inch-intel)/83cv000smj", "shopee_url": "https://shopee.com.my/search?keyword=Yoga%20Slim%207i", "tiktok_url": null, "score": 82, "platform": "NPU", "why": "Premium build, lightweight chassis, and a gorgeous OLED screen.", "scores": { "ai": 7, "thermals": 7, "upgrade": 2, "linux": 6, "portability": 9, "value": 8 } },
          { "brand": "Lenovo", "model": "LOQ 15IRH8", "price": 4859, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Lenovo+LOQ+15", "cpu": "Intel Core i5-13420H", "gpu": "NVIDIA RTX 4050 6GB", "ram": "8GB DDR5", "storage": "512GB NVMe SSD", "display": "15.6\" FHD 144Hz", "price_source_url": "https://www.lenovo.com/my/en/p/laptops/loq-laptops/lenovo-loq-15irh8/82xv00l2mj", "shopee_url": "https://shopee.com.my/search?keyword=LOQ%2015IRH8", "tiktok_url": null, "score": 81, "platform": "CUDA", "why": "Brings excellent Legion keyboard and thermals to a more affordable price.", "scores": { "ai": 8, "thermals": 8, "upgrade": 8, "linux": 8, "portability": 6, "value": 9 } },
          { "brand": "LG", "model": "Gram 16 (16Z90S)", "price": 6899, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=LG+Gram+16", "cpu": "Intel Core Ultra 7 155H", "gpu": "Intel Arc Graphics", "ram": "16GB LPDDR5X", "storage": "512GB NVMe SSD", "display": "16\" WQXGA IPS", "price_source_url": "https://www.lg.com/my/laptops/lg-16z90s-g.ap75a2", "shopee_url": "https://shopee.com.my/search?keyword=LG%20Gram%2016", "tiktok_url": null, "score": 81, "platform": "NPU", "why": "Legendary light weight makes a 16-inch screen feel extremely portable.", "scores": { "ai": 8, "thermals": 7, "upgrade": 2, "linux": 6, "portability": 10, "value": 7 } },
          { "brand": "HP", "model": "Pavilion Plus 14", "price": 4799, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=HP+Pavilion+Plus", "cpu": "Intel Core Ultra 7 155U", "gpu": "Intel Graphics", "ram": "16GB LPDDR5X", "storage": "1TB NVMe SSD", "display": "14\" 2.8K OLED", "price_source_url": "https://www.hp.com/my-en/shop/laptops-tablets/hp-pavilion-plus-laptop-14-ew1011tu-9q999pa.html", "shopee_url": "https://shopee.com.my/search?keyword=HP%20Pavilion%20Plus%2014", "tiktok_url": null, "score": 81, "platform": "NPU", "why": "Well-rounded ultrabook with 2.8K OLED and Intel Ultra 7 at a competitive price.", "scores": { "ai": 7, "thermals": 7, "upgrade": 2, "linux": 6, "portability": 9, "value": 8 } },
          { "brand": "Infinix", "model": "GTBook Pro (X1614)", "price": 4999, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Infinix+GTBook", "cpu": "Intel Core i9-13900H", "gpu": "NVIDIA RTX 4060 8GB", "ram": "16GB LPDDR5X", "storage": "512GB NVMe SSD", "display": "16\" FHD 120Hz", "price_source_url": "https://my.infinixmobility.com/laptops/gtbook-pro", "shopee_url": "https://shopee.com.my/search?keyword=Infinix%20GTBook%20Pro", "tiktok_url": null, "score": 80, "platform": "CUDA", "why": "Aggressive new market entry pushing the price-to-performance boundary.", "scores": { "ai": 9, "thermals": 7, "upgrade": 7, "linux": 5, "portability": 6, "value": 10 } },
          { "brand": "Honor", "model": "MagicBook X 16 Pro (2024)", "price": 4299, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Honor+MagicBook", "cpu": "Intel Core i5-13500H", "gpu": "Intel Iris Xe", "ram": "16GB LPDDR5", "storage": "512GB NVMe SSD", "display": "16\" FHD IPS", "price_source_url": "https://www.hihonor.com/my/laptops/honor-magicbook-x-16-pro-2024/", "shopee_url": "https://shopee.com.my/search?keyword=MagicBook%20X%2016%20Pro", "tiktok_url": null, "score": 80, "platform": "NPU", "why": "Solid value proposition with a large screen and sleek, professional look.", "scores": { "ai": 7, "thermals": 7, "upgrade": 2, "linux": 6, "portability": 7, "value": 9 } },
          { "brand": "MSI", "model": "Thin GF63 12VE", "price": 4799, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=MSI+Thin+GF63", "cpu": "Intel Core i7-12650H", "gpu": "NVIDIA RTX 4050 6GB", "ram": "8GB DDR4", "storage": "512GB NVMe SSD", "display": "15.6\" FHD 144Hz", "price_source_url": "https://my.msi.com/Laptop/Thin-GF63-12VX/Specification", "shopee_url": "https://shopee.com.my/search?keyword=MSI%20Thin%20GF63", "tiktok_url": null, "score": 79, "platform": "CUDA", "why": "Lightweight gaming laptop offering an accessible RTX 4050 for CUDA.", "scores": { "ai": 8, "thermals": 7, "upgrade": 7, "linux": 6, "portability": 7, "value": 8 } },
          { "brand": "HP", "model": "Envy x360 14", "price": 5399, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=HP+Envy+x360", "cpu": "Intel Core Ultra 5 125U", "gpu": "Intel Graphics", "ram": "16GB LPDDR5", "storage": "512GB NVMe SSD", "display": "14\" FHD+ OLED Touch", "price_source_url": "https://www.hp.com/my-en/shop/laptops-tablets/hp-envy-x360-2-in-1-laptop-14-es1002tu-9q9a0pa.html", "shopee_url": "https://shopee.com.my/search?keyword=HP%20Envy%20x360%2014", "tiktok_url": null, "score": 79, "platform": "NPU", "why": "A versatile 2-in-1 with a quality build, touchscreen, and efficient NPU.", "scores": { "ai": 7, "thermals": 7, "upgrade": 2, "linux": 6, "portability": 8, "value": 7 } },
          { "brand": "HP", "model": "Victus 15", "price": 4599, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=HP+Victus+15", "cpu": "Intel Core i5-13420H", "gpu": "NVIDIA RTX 3050 6GB", "ram": "8GB DDR4", "storage": "512GB NVMe SSD", "display": "15.6\" FHD 144Hz", "price_source_url": "https://www.hp.com/my-en/shop/laptops-tablets/victus-gaming-laptop-15-fa1034tx-8v1v8pa.html", "shopee_url": "https://shopee.com.my/search?keyword=HP%20Victus%2015", "tiktok_url": null, "score": 78, "platform": "CUDA", "why": "Clean, minimalist design with good RTX 3050 performance for its price.", "scores": { "ai": 7, "thermals": 7, "upgrade": 7, "linux": 7, "portability": 6, "value": 8 } },
          { "brand": "Acer", "model": "Aspire 7 Gaming", "price": 3899, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Acer+Aspire+7", "cpu": "Intel Core i5-12450H", "gpu": "NVIDIA RTX 3050 4GB", "ram": "8GB DDR4", "storage": "512GB NVMe SSD", "display": "15.6\" FHD 144Hz", "price_source_url": "https://store.acer.com/en-my/acer-aspire-7-gaming-laptop-a715-76g-50na", "shopee_url": "https://shopee.com.my/search?keyword=Acer%20Aspire%207", "tiktok_url": null, "score": 76, "platform": "CUDA", "why": "The lowest-cost entry to a discrete RTX GPU on the list; solid beginner value.", "scores": { "ai": 7, "thermals": 6, "upgrade": 8, "linux": 7, "portability": 6, "value": 9 } },
          { "brand": "Microsoft", "model": "Surface Laptop 5 15-inch", "price": 6500, "imageUrl": "https://placehold.co/600x400/2A4A5C/FFFFFF?text=Surface+Laptop+5", "cpu": "Intel Core i7-1255U", "gpu": "Intel Iris Xe", "ram": "16GB LPDDR5X", "storage": "512GB SSD", "display": "15\" PixelSense", "price_source_url": "https://www.microsoft.com/en-my/surface/devices/surface-laptop-5", "shopee_url": "https://shopee.com.my/search?keyword=Surface%20Laptop%205", "tiktok_url": null, "score": 75, "platform": "NPU", "why": "Classic premium design with an excellent keyboard and trackpad.", "scores": { "ai": 6, "thermals": 8, "upgrade": 1, "linux": 6, "portability": 8, "value": 6 } }
      ]
    },
    ui: {
      app: { price: 7000, platform: 'All', brand: 'All', sort: 'score_desc', radarSelection: [] },
      charts: { rankings: null, radar: null, value: null },
      elements: {}
    },
    config: {
      chartFont: { family: "'Share Tech Mono', monospace", size: 12 },
      platformColors: { CUDA: 'text-[#00F0FF]', NPU: 'text-[#D83F87]', Mac: 'text-gray-400' },
      platformColorMap: { CUDA: 'rgba(0, 240, 255, 0.7)', NPU: 'rgba(216, 63, 135, 0.7)', Mac: 'rgba(168, 178, 204, 0.7)' }
    },
    affiliate: {
      SHOPEE_AFFILIATE_ID: self.SHOPEE_AFFILIATE_ID || null,
      LAZADA_AFFILIATE_ID: self.LAZADA_AFFILIATE_ID || null,
      TIKTOK_AFFILIATE_ID: self.TIKTOK_AFFILIATE_ID || null,
      INVOLVE_ASIA_ID: self.INVOLVE_ASIA_ID || null
    }
  };

  // --- API & DATA MODULE ----------------------------------------------------
  const API_MODULE = {
    buildAffiliateLink(originalUrl, platform) {
        if (!originalUrl) return '#';
        const { SHOPEE_AFFILIATE_ID } = STATE.affiliate;
        if (platform === 'shopee' && SHOPEE_AFFILIATE_ID) {
            return `${originalUrl}&af_id=${SHOPEE_AFFILIATE_ID}`;
        }
        return originalUrl;
    },
    async fetchMarketIntel() {
        try {
            const response = await fetch('data/laptops.json');
            if (!response.ok) throw new Error('Local JSON not found.');
            STATE.data.allLaptops = await response.json();
        } catch (error) {
            console.warn(error.message, "Using embedded fallback data.");
            STATE.data.allLaptops = STATE.data.fallbackLaptops;
        }
    },
    async callAIAgent(task, payload, outputElement) {
        if (outputElement) outputElement.innerHTML = '<span class="animate-pulse">AI Bradaa is thinking...</span>';
        
        const { systemPrompt, userPrompt, generationConfig } = this.getPromptsForTask(task, payload);
        const apiKey = ""; 
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

        const requestBody = {
            contents: [{ parts: [{ text: userPrompt }] }],
            systemInstruction: { parts: [{ text: systemPrompt }] },
            generationConfig,
            tools: (task === 'deal-assassin' || task === 'getFutureIntel') ? [{ "google_search": {} }] : []
        };

        try {
            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(requestBody)
            });
            if (!response.ok) throw new Error(`API Error: ${response.status} ${response.statusText}`);
            
            const result = await response.json();
            const text = result.candidates?.[0]?.content?.parts?.[0]?.text;

            if (task === 'getFutureIntel') {
                try {
                    const intelData = JSON.parse(text);
                    if(intelData.intelligence) {
                        UI_MODULE.updateIntelUI(intelData.intelligence);
                    } else { throw new Error("Formatted JSON not found in AI response for Intel."); }
                } catch(e) {
                    console.error("Failed to parse Intel JSON:", e, "Raw text:", text);
                    UI_MODULE.updateIntelUIWithRawText(text);
                }
            } else {
                 if (outputElement) outputElement.innerHTML = text || 'Sorry, AI Bradaa could not provide a clear answer. Please try again.';
            }
        } catch (error) {
            console.error('AI Agent Call Failed:', error);
            if (outputElement) outputElement.textContent = 'ERROR: Could not connect to the AI. Please check your connection and try again.';
        }
    },
    getPromptsForTask(task, payload) {
        let systemPrompt = "Yo! I'm AI Bradaa, your tech-savvy buddy from Malaysia. I keep things simple, direct, and always look for the best value, just like any smart Malaysian would. No confusing jargon, just straight-up good advice. I format my answers with Markdown for clarity, using headings (###) and bullet points (*).";
        let userPrompt = `My friend needs help! Here's the situation:\n\n${JSON.stringify(payload, null, 2)}`;
        let generationConfig = { responseMimeType: "text/plain" };

        switch(task) {
            case 'findMatch':
                systemPrompt = "Yo, I'm AI Bradaa! You need a laptop? Easy. I'll pick the single best option from the list based on your needs. I'll explain my choice simply, with a clear '### Recommendation' heading, followed by '### Why I Chose This' with bullet points, so you know exactly why it's the right gear for you. Let's do this.";
                userPrompt = `My friend is looking for a laptop. Here's what they need:\n- Budget: ${payload.criteria.budget}\n- Main Use: ${payload.criteria.usecase}\n- Portability: ${payload.criteria.portability}\n\nBased on this list of laptops, which single one is the best choice and why? Keep it simple.\n\n${JSON.stringify(payload.laptops, null, 2)}`;
                break;
            case 'compareLaptops':
                systemPrompt = "Yo, I'm AI Bradaa. You're stuck between a few laptops? Let's break it down. I'll compare them side-by-side using Markdown headings (###) for each model and bullet points (*) for the pros and cons. No fluff.";
                userPrompt = `Help me compare these laptops. What are the main differences?\n\n${JSON.stringify(payload.laptops, null, 2)}`;
                break;
            case 'getFutureIntel':
                systemPrompt = "Yo, I'm AI Bradaa. I'll get you the latest tech intel, fast. I will provide a JSON object with a key 'intelligence' which is an array of three objects. Each object must have three string keys: 'title', 'summary' (one simple sentence), and 'verdict' (one word, e.g., 'SOLID', 'WAIT', 'HYPE').";
                userPrompt = "What are the three most important tech news updates for consumers in Malaysia right now?";
                generationConfig.responseMimeType = "application/json";
                generationConfig.responseSchema = { type: "OBJECT", properties: { "intelligence": { type: "ARRAY", items: { type: "OBJECT", properties: { "title": { "type": "STRING" }, "summary": { "type": "STRING" }, "verdict": { "type": "STRING" } } } } } };
                break;
        }
        return { systemPrompt, userPrompt, generationConfig };
    }
  };

  // --- UI MODULE -----------------------------------------------------------
  const UI_MODULE = {
    configureCharts() {
        if (!window.Chart) return;
        Chart.defaults.color = '#A8B2CC';
        Chart.defaults.font = STATE.config.chartFont;
        Chart.defaults.borderColor = 'rgba(48, 54, 61, 0.8)';
    },
    renderAll() {
        const data = APP.computeFilteredSet();
        this.renderAppendicesList(data);
        this.renderCharts(data);
    },
    updateIntelUI(intelligence) {
        intelligence.forEach((item, index) => {
            const el = id => document.getElementById(id);
            if(el(`intel-${index}-title`)) el(`intel-${index}-title`).textContent = item.title;
            if(el(`intel-${index}-summary`)) el(`intel-${index}-summary`).textContent = item.summary;
            if(el(`intel-${index}-verdict`)) el(`intel-${index}-verdict`).textContent = item.verdict;
        });
    },
    updateIntelUIWithRawText(text) {
        const summaryEl = document.getElementById('intel-0-summary');
        const titleEl = document.getElementById('intel-0-title');
        if (titleEl) titleEl.textContent = "Intel Feed Anomaly";
        if (summaryEl) summaryEl.textContent = `AI Bradaa found something, but it's a bit scrambled! Here's the raw message: ${text}`;
    },
    renderAppendicesList(data) {
        const container = document.getElementById('laptop-list-container');
        if (!container) return;
        container.innerHTML = data.length === 0 ? '<p class="text-center text-lg text-[var(--c-text-secondary)] xl:col-span-3">No units match current filter parameters.</p>' 
        : data.map((l, index) => `
          <div class="card bg-[var(--c-bg)] flex flex-col overflow-hidden">
            <img src="${l.imageUrl}" alt="${l.model}" class="w-full h-48 object-cover" onerror="this.onerror=null;this.src='https://placehold.co/600x400/1a1a1a/4a4a4a?text=Intel+Image';">
            <div class="p-4 flex flex-col flex-grow">
              <div class="flex-grow">
                <div class="flex justify-between items-start">
                  <span class="text-xs font-semibold uppercase tracking-wider text-[var(--c-text-secondary)]">${l.brand}</span>
                  <span class="text-sm font-bold py-1 px-2 rounded-full ${l.platform === 'CUDA' ? 'bg-cyan-900/50 text-cyan-300' : l.platform === 'NPU' ? 'bg-pink-900/50 text-pink-300' : 'bg-gray-700/50 text-gray-300'}">${l.platform}</span>
                </div>
                <h4 class="font-semibold text-sm mt-1 text-[var(--c-text-primary)] font-body">${l.model}</h4>
                <p class="text-xs text-[var(--c-text-secondary)] mt-2 italic">"${l.why}"</p>
              </div>
              <div class="mt-4 pt-3 border-t border-[var(--c-border)] text-xs text-[var(--c-text-secondary)] space-y-1">
                <p><b class="font-semibold w-16 inline-block text-[var(--c-text-primary)]">CPU:</b> ${l.cpu}</p>
                <p><b class="font-semibold w-16 inline-block text-[var(--c-text-primary)]">GPU:</b> ${l.gpu}</p>
                <p><b class="font-semibold w-16 inline-block text-[var(--c-text-primary)]">RAM:</b> ${l.ram}</p>
                <p><b class="font-semibold w-16 inline-block text-[var(--c-text-primary)]">Display:</b> ${l.display}</p>
              </div>
              <div class="mt-4 border-t border-[var(--c-border)] pt-4">
                <div class="flex justify-between items-center text-sm">
                  <span class="font-semibold text-lg text-[var(--c-text-primary)]">RM ${l.price}</span>
                  <div class="text-right">
                    <span class="block text-xs text-[var(--c-text-secondary)]">Score</span>
                    <span class="font-bold text-lg text-[var(--c-accent-cyan)]">${l.score}</span>
                  </div>
                </div>
                <div class="relative mt-3">
                    <button data-action="toggle-price-menu" data-index="${index}" class="w-full text-center bg-[var(--c-accent-cyan)] text-[var(--c-bg)] text-xs font-bold py-2 px-3 rounded-md hover:opacity-90 transition flex items-center justify-center">
                        Check Price
                        <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="price-menu-${index}" class="price-menu hidden absolute bottom-full mb-2 w-full bg-[var(--c-bg)] border border-[var(--c-border)] rounded-md shadow-lg z-10 overflow-hidden">
                        <a href="${API_MODULE.buildAffiliateLink(l.price_source_url, 'official')}" target="_blank" class="block px-4 py-2 text-xs text-[var(--c-text-secondary)] hover:bg-[var(--c-border)]">Official Website</a>
                        <a href="${API_MODULE.buildAffiliateLink(l.shopee_url, 'shopee')}" target="_blank" class="block px-4 py-2 text-xs text-[var(--c-text-secondary)] hover:bg-[var(--c-border)]">Shopee</a>
                        ${l.tiktok_url ? `<a href="${API_MODULE.buildAffiliateLink(l.tiktok_url, 'tiktok')}" target="_blank" class="block px-4 py-2 text-xs text-[var(--c-text-secondary)] hover:bg-[var(--c-border)]">Tiktok Shop</a>` : ''}
                    </div>
                </div>
              </div>
            </div>
          </div>
        `).join('');
    },
    renderCharts(data) {
        const top15 = data.slice(0, 15);
        const rankingsData = {
            labels: top15.map(d => d.model),
            datasets: [{ label: 'Score', data: top15.map(d => d.score), backgroundColor: 'rgba(0, 240, 255, 0.7)' }]
        };
        if (!STATE.ui.charts.rankings) {
            STATE.ui.charts.rankings = new Chart('rankingsChart', { type: 'bar', data: rankingsData, options: { indexAxis: 'y', responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { x: { beginAtZero: true, max: 100 } } } });
        } else {
            STATE.ui.charts.rankings.data = rankingsData;
            STATE.ui.charts.rankings.update();
        }
        const valueData = {
            datasets: [{
                data: data.map(d => ({ x: d.price, y: d.score, model: d.model })),
                backgroundColor: data.map(d => STATE.config.platformColorMap[d.platform]),
                pointRadius: 6, pointHoverRadius: 10
            }]
        };
        if (!STATE.ui.charts.value) {
            STATE.ui.charts.value = new Chart('valueChart', { type: 'scatter', data: valueData, options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => `${c.raw.model}: RM${c.raw.x}, Score: ${c.raw.y}` } } }, scales: { x: { title: { display: true, text: 'Price (RM)' } }, y: { title: { display: true, text: 'Score' } } } } });
        } else {
            STATE.ui.charts.value.data = valueData;
            STATE.ui.charts.value.update();
        }
    },
    renderRadarChart() {
        if (!STATE.data.allLaptops.length) return;
        const selected = STATE.data.allLaptops.filter(l => STATE.ui.app.radarSelection.includes(l.model));
        const colors = ['#D83F87', '#00F0FF', '#F8F32B'];
        const datasets = selected.map((laptop, i) => {
            const hex = colors[i];
            const r = parseInt(hex.slice(1, 3), 16), g = parseInt(hex.slice(3, 5), 16), b = parseInt(hex.slice(5, 7), 16);
            return {
                label: laptop.model,
                data: Object.values(laptop.scores),
                fill: true,
                backgroundColor: `rgba(${r},${g},${b},0.2)`,
                borderColor: hex,
                pointBackgroundColor: hex
            };
        });
        const radarData = { labels: ['AI', 'Thermals', 'Upgrade', 'Linux', 'Portability', 'Value'], datasets };
        if (!STATE.ui.charts.radar) {
            STATE.ui.charts.radar = new Chart('radarChart', { type: 'radar', data: radarData, options: { responsive: true, maintainAspectRatio: false, scales: { r: { beginAtZero: true, max: 10, pointLabels: { font: STATE.config.chartFont }, ticks: { display: false } } } } });
        } else {
            STATE.ui.charts.radar.data = radarData;
            STATE.ui.charts.radar.update();
        }
        const out = document.getElementById('gemini-comparison-output');
        if (selected.length >= 2) {
            API_MODULE.callAIAgent('compareLaptops', { laptops: selected }, out);
        } else if (out) {
            out.textContent = 'Select some laptops above to see the AI Bradaa\'s simple comparison...';
        }
    },
    renderToolkitConsole(toolId) {
        const consoleEl = document.getElementById('toolkit-console');
        if (!consoleEl) return;
        const laptopOptions = STATE.data.allLaptops.map(l => `<option value="${l.model.replace(/"/g, '&quot;')}">${l.model}</option>`).join('');
        const toolUIs = {
          'deal-assassin': `<div class="flex-grow flex flex-col"><label class="mb-2">Product Name:</label><input type="text" id="tool-input-query" placeholder="e.g., Illegear Z7" class="w-full mb-4"><button data-tool-action="deal-assassin" class="action-button mt-auto">✨ Find Best Deal</button></div>`,
          'upgrade-strategist': `<div class="flex-grow flex flex-col"><label class="mb-2">Base Laptop:</label><select id="tool-input-laptop" class="w-full mb-4">${laptopOptions}</select><label class="mb-2">Goal:</label><select id="tool-input-goal" class="w-full mb-4"><option>Run 13B models smoothly</option><option>Maximize storage</option></select><button data-tool-action="upgrade-strategist" class="action-button mt-auto">✨ Get Upgrade Plan</button></div>`,
          'dream-rig-architect': `<div class="flex-grow flex flex-col"><label class="mb-2">Budget (MYR):</label><input type="number" id="tool-input-budget" placeholder="e.g., 8000" class="w-full mb-4"><label class="mb-2">Use:</label><select id="tool-input-use" class="w-full mb-4"><option>AI & CUDA Development</option><option>4K Gaming</option></select><button data-tool-action="dream-rig-architect" class="action-button mt-auto">✨ Architect My Rig</button></div>`,
          'elite-procurement': `<div class="flex-grow flex flex-col"><label class="mb-2">Rare Item:</label><input type="text" id="tool-input-item" placeholder="e.g., Razer Blade 16 Mini-LED" class="w-full mb-4"><button data-tool-action="elite-procurement" class="action-button mt-auto">✨ Initiate Scan</button></div>`,
          'component-recon': `<div class="flex-grow flex flex-col"><label class="mb-2">Component Model:</label><input type="text" id="tool-input-component" placeholder="e.g., Core Ultra 9 185H" class="w-full mb-4"><button data-tool-action="component-recon" class="action-button mt-auto">✨ Run Recon</button></div>`,
          'performance-forecaster': `<div class="flex-grow flex flex-col"><label class="mb-2">Laptop:</label><select id="tool-input-laptop" class="w-full mb-4">${laptopOptions}</select><label class="mb-2">Application:</label><input type="text" id="tool-input-app" placeholder="e.g., Stable Diffusion XL" class="w-full mb-4"><button data-tool-action="performance-forecaster" class="action-button mt-auto">✨ Forecast</button></div>`,
          'system-integrity': `<div class="flex-grow flex flex-col"><label class="mb-2">Issue:</label><textarea id="tool-input-issue" placeholder="e.g., 'BSOD when running PyTorch'" class="w-full mb-4 h-24"></textarea><button data-tool-action="system-integrity" class="action-button mt-auto">✨ Analyze</button></div>`,
          'ecosystem-architect': `<div class="flex-grow flex flex-col"><label class="mb-2">Current Devices:</label><input type="text" id="tool-input-devices" placeholder="e.g., iPhone 15 Pro, iPad Air" class="w-full mb-4"><button data-tool-action="ecosystem-architect" class="action-button mt-auto">✨ Find Best Fit</button></div>`,
          'longevity-analyst': `<div class="flex-grow flex flex-col"><label class="mb-2">Laptop:</label><select id="tool-input-laptop" class="w-full mb-4">${laptopOptions}</select><button data-tool-action="longevity-analyst" class="action-button mt-auto">✨ Analyze Longevity</button></div>`,
          'asset-value': `<div class="flex-grow flex flex-col"><label class="mb-2">Laptop:</label><select id="tool-input-laptop" class="w-full mb-4">${laptopOptions}</select><label class="mb-2">Condition:</label><select id="tool-input-condition" class="w-full mb-4"><option>Like New</option><option>Good</option><option>Fair</option></select><button data-tool-action="asset-value" class="action-button mt-auto">✨ Forecast Value</button></div>`,
          'field-support': `<div class="flex-grow flex flex-col"><label class="mb-2">Query:</label><textarea id="tool-input-query" placeholder="e.g., How to dual-boot Ubuntu?" class="w-full mb-4 h-24"></textarea><button data-tool-action="field-support" class="action-button mt-auto">✨ Request Support</button></div>`,
          'default': `<p class="text-lg text-[var(--c-text-secondary)]">Select a tool to begin operation.</p>`
        };
        consoleEl.innerHTML = `
            ${toolUIs[toolId] || toolUIs['default']}
            <div id="toolkit-output" class="mt-4 p-4 bg-black/50 rounded-lg min-h-[150px] text-sm text-[var(--c-text-secondary)] gemini-output">Output will appear here...</div>
        `;
        consoleEl.classList.remove('console-animating');
        void consoleEl.offsetWidth;
        consoleEl.classList.add('console-animating');
      }
  };
  
  // --- APP CONTROLLER & INITIALIZATION --------------------------------------
  const APP = {
      computeFilteredSet() {
        const { price, platform, brand, sort } = STATE.ui.app;
        if (!STATE.data.sortedByRank || STATE.data.sortedByRank.length === 0) return [];
        let data = STATE.data.sortedByRank.filter(d =>
          d.price <= price &&
          (platform === 'All' || d.platform === platform) &&
          (brand === 'All' || d.brand === brand)
        );
        const sorter = {
          price_asc: (a, b) => a.price - b.price,
          price_desc: (a, b) => b.price - a.price,
          score_desc: (a, b) => b.score - a.score,
          value_desc: (a, b) => b.value_rating - a.value_rating
        };
        data.sort(sorter[sort] || sorter.score_desc);
        return data;
      },
      setupEventListeners() {
        document.getElementById('price-filter')?.addEventListener('input', e => { STATE.ui.app.price = Number(e.target.value); document.getElementById('price-value').textContent = e.target.value; UI_MODULE.renderAll(); });
        document.querySelectorAll('.platform-filter').forEach(btn => btn.addEventListener('click', () => { document.querySelector('.platform-filter.active')?.classList.remove('active'); btn.classList.add('active'); STATE.ui.app.platform = btn.dataset.platform; UI_MODULE.renderAll(); }));
        document.getElementById('sort-filter')?.addEventListener('change', e => { STATE.ui.app.sort = e.target.value; UI_MODULE.renderAll(); });
        document.getElementById('brand-filter')?.addEventListener('change', e => { STATE.ui.app.brand = e.target.value; UI_MODULE.renderAll(); });
        
        document.getElementById('find-match-btn')?.addEventListener('click', () => {
            const payload = {
                criteria: {
                    budget: document.getElementById('match-budget').value,
                    usecase: document.getElementById('match-usecase').value,
                    portability: document.getElementById('match-portability').value
                },
                laptops: STATE.data.allLaptops
            };
            API_MODULE.callAIAgent('findMatch', payload, document.getElementById('matchmaker-output'));
        });

        document.getElementById('laptop-selector-container')?.addEventListener('click', e => {
            if (!e.target.classList.contains('radar-selector')) return;
            const btn = e.target;
            const model = btn.dataset.model;
            const idx = STATE.ui.app.radarSelection.indexOf(model);
            if (idx > -1) { STATE.ui.app.radarSelection.splice(idx, 1); btn.classList.remove('active'); }
            else if (STATE.ui.app.radarSelection.length < 3) { STATE.ui.app.radarSelection.push(model); btn.classList.add('active'); }
            UI_MODULE.renderRadarChart();
        });

        document.querySelectorAll('.tool-selector-btn').forEach(btn => btn.addEventListener('click', (e) => {
            document.querySelectorAll('.tool-selector-btn.active').forEach(b => b.classList.remove('active'));
            e.currentTarget.classList.add('active');
            UI_MODULE.renderToolkitConsole(e.currentTarget.dataset.tool);
        }));

        document.getElementById('toolkit-console')?.addEventListener('click', e => {
            if (!e.target.matches('[data-tool-action]')) return;
            e.preventDefault();
            const action = e.target.dataset.toolAction;
            const outputEl = document.getElementById('toolkit-output');
            let payload = {};
            const inputs = document.querySelectorAll('#toolkit-console [id^="tool-input-"]');
            inputs.forEach(input => {
                const key = input.id.replace('tool-input-', '');
                payload[key] = input.value;
            });
            if (['performance-forecaster', 'longevity-analyst', 'upgrade-strategist'].includes(action)) {
                payload.laptopData = STATE.data.allLaptops.find(l => l.model === payload.laptop);
            }
            API_MODULE.callAIAgent(action, payload, outputEl);
        });

        document.body.addEventListener('click', e => {
            const priceToggle = e.target.closest('[data-action="toggle-price-menu"]');
            document.querySelectorAll('.price-menu:not(.hidden)').forEach(m => {
                if (!priceToggle || m.id !== `price-menu-${priceToggle.dataset.index}`) {
                    m.classList.add('hidden');
                }
            });
            if (priceToggle) {
                const menu = document.getElementById(`price-menu-${priceToggle.dataset.index}`);
                if (menu) menu.classList.toggle('hidden');
            }
        });

        const navLinks = document.querySelectorAll('.nav-button');
        const sections = document.querySelectorAll('main section');
        const observer = new IntersectionObserver(entries => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const id = entry.target.id;
              navLinks.forEach(link => link.classList.toggle('active', link.getAttribute('href') === `#${id}`));
            }
          });
        }, { rootMargin: '-40% 0px -60% 0px' });
        sections.forEach(section => observer.observe(section));
      },
      async initialize() {
        UI_MODULE.configureCharts();
        await API_MODULE.fetchMarketIntel();
        
        STATE.data.allLaptops.forEach(l => l.value_rating = (l.score * 100) / l.price);
        STATE.data.sortedByRank = [...STATE.data.allLaptops].sort((a, b) => b.score - a.score).map((item, index) => ({ ...item, rank: index + 1 }));

        const brandSelect = document.getElementById('brand-filter');
        if (brandSelect) {
          brandSelect.innerHTML = '<option value="All" selected>All Brands</option>' + [...new Set(STATE.data.allLaptops.map(l => l.brand))].sort().map(b => `<option value="${b}">${b}</option>`).join('');
        }
        
        const selector = document.getElementById('laptop-selector-container');
        if (selector) {
          selector.innerHTML = STATE.data.sortedByRank.map(l => `<button class="filter-button radar-selector border border-[var(--c-border)] px-2 py-1 text-xs rounded-md truncate" data-model="${l.model.replace(/"/g, '&quot;')}" title="${l.model}">${l.model}</button>`).join('');
        }

        UI_MODULE.renderAll();
        UI_MODULE.renderRadarChart();
        UI_MODULE.renderToolkitConsole('deal-assassin');
        this.setupEventListeners();
        
        API_MODULE.callAIAgent('getFutureIntel', {}, null);
      }
  };
  
  document.addEventListener('DOMContentLoaded', () => APP.initialize());
})();
</script>
</body>
</html>

